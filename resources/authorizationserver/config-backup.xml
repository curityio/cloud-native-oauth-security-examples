<config xmlns="http://tail-f.com/ns/config/1.0">
  <environments xmlns="https://curity.se/ns/conf/base">
    <environment>
      <base-url>#{RUNTIME_BASE_URL}</base-url>
      <admin-service>
        <http>
          <base-url>#{ADMIN_BASE_URL}</base-url>
          <web-ui>
          </web-ui>
          <restconf>
          </restconf>
        </http>
      </admin-service>
      <services>
        <zones>
          <default-zone>
            <symmetric-key>data:text/plain;aes,v:S.T0lvNEJ1cXdvczVEUkJ5eg==.AxhEIrlBlMcg7zRL6UqwSw==.Qg01CG0w9gTYEHygEJfGiiRZIk7rM0-wsdNZ0mlelTdo77Xn1bXXc1Aw_6BqrfcAFOokvPtMdCL6YB94oVenFnadtHGeB-1_W6wJCGq_8ig=.mD5oghSSseWUb9a5a9Wv_G9wSbz0U1fdSnIdEcvQDU8=</symmetric-key>
          </default-zone>
        </zones>
        <service-role>
          <id>default</id>
          <protocol>http</protocol>
          <webfinger/>
          <endpoints>authentication-service-anonymous</endpoints>
          <endpoints>authentication-service-authentication</endpoints>
          <endpoints>authentication-service-registration</endpoints>
          <endpoints>token-service-anonymous</endpoints>
          <endpoints>token-service-assisted-token</endpoints>
          <endpoints>token-service-authorize</endpoints>
          <endpoints>token-service-introspect</endpoints>
          <endpoints>token-service-revoke</endpoints>
          <endpoints>token-service-session</endpoints>
          <endpoints>token-service-token</endpoints>
          <endpoints>token-service-userinfo</endpoints>
        </service-role>
      </services>
    </environment>
  </environments>
  <profiles xmlns="https://curity.se/ns/conf/base">
    <profile>
      <id>authentication-service</id>
      <type xmlns:auth="https://curity.se/ns/conf/profile/authentication">auth:authentication-service</type>
      <expose-detailed-error-messages/>
      <settings>
        <authentication-service xmlns="https://curity.se/ns/conf/profile/authentication">
          <authenticators>
            <authenticator>
              <id>html-form</id>
              <html-form xmlns="https://curity.se/ns/conf/authenticators/html-form">
                <account-manager>default-account-manager</account-manager>
                <credential-manager>default-credential-manager</credential-manager>
              </html-form>
            </authenticator>
          </authenticators>
          <protocols>
            <protocol>
              <id>default-simple-protocol</id>
              <simple-api/>
            </protocol>
          </protocols>
        </authentication-service>
      </settings>
      <endpoints>
        <endpoint>
          <id>authentication-service-anonymous</id>
          <uri>/authn/anonymous</uri>
          <endpoint-kind>auth-anonymous</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>authentication-service-authentication</id>
          <uri>/authn/authentication</uri>
          <endpoint-kind>auth-authentication</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>authentication-service-registration</id>
          <uri>/authn/registration</uri>
          <endpoint-kind>auth-registration</endpoint-kind>
        </endpoint>
      </endpoints>
      <token-issuers>
        <default-token-issuer>
          <jwt-issuer-settings>
            <algorithm>ES256</algorithm>
            <signing-key-id>default-signing-key</signing-key-id>
          </jwt-issuer-settings>
          <default-data-source>default-datasource</default-data-source>
        </default-token-issuer>
      </token-issuers>
    </profile>
    <profile>
      <id>token-service</id>
      <type xmlns:as="https://curity.se/ns/conf/profile/oauth">as:oauth-service</type>
      <expose-detailed-error-messages/>
      <settings>
        <authorization-server xmlns="https://curity.se/ns/conf/profile/oauth">
          <authentication-service>
            <authentication-profile>authentication-service</authentication-profile>
          </authentication-service>
          <client-capabilities>
            <code>
            </code>
            <implicit/>
            <resource-owner-password-credentials>
              <credential-manager>default-credential-manager</credential-manager>
            </resource-owner-password-credentials>
            <client-credentials/>
            <introspection/>
            <token-exchange/>
          </client-capabilities>
          <scopes>
            <scope>
              <id>address</id>
              <description>OpenId Connect address scope</description>
              <claims>address</claims>
            </scope>
            <scope>
              <id>email</id>
              <description>OpenId Connect email scope</description>
              <claims>email</claims>
              <claims>email_verified</claims>
            </scope>
            <scope>
              <id>openid</id>
              <description>Standard OpenID Connect scope</description>
            </scope>
            <scope>
              <id>phone</id>
              <description>OpenId Connect phone scope</description>
              <claims>phone_number</claims>
              <claims>phone_number_verified</claims>
            </scope>
            <scope>
              <id>profile</id>
              <description>OpenId Connect profile scope</description>
              <claims>birthdate</claims>
              <claims>family_name</claims>
              <claims>gender</claims>
              <claims>given_name</claims>
              <claims>locale</claims>
              <claims>middle_name</claims>
              <claims>name</claims>
              <claims>nickname</claims>
              <claims>picture</claims>
              <claims>preferred_username</claims>
              <claims>profile</claims>
              <claims>updated_at</claims>
              <claims>website</claims>
              <claims>zoneinfo</claims>
            </scope>
            <scope>
              <id>retail/orders</id>
              <claims>customer_id</claims>
              <claims>level_of_assurance</claims>
              <claims>region</claims>
              <claims>roles</claims>
            </scope>
          </scopes>
          <claims>
            <claim>
              <name>address</name>
              <description>OpenID Connect address claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>birthdate</name>
              <description>OpenID Connect birthdate claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>customer_id</name>
              <value-provided-by>custom-claims-provider</value-provided-by>
              <transformation>
								<input-attribute-names>data</input-attribute-names>
								<value-transformation-procedure>ZnVuY3Rpb24gdHJhbnNmb3JtKGF0dHJpYnV0ZXMpIHsKICAgIHZhciBkYXRhID0gSlNPTi5wYXJzZShhdHRyaWJ1dGVzLmRhdGEpOwogICAgcmV0dXJuIGRhdGEuY3VzdG9tZXJJZDsKfQ==</value-transformation-procedure>
							</transformation>
            </claim>
            <claim>
              <name>email</name>
              <description>OpenID Connect email claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>email_verified</name>
              <description>OpenID Connect email_verified claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>family_name</name>
              <description>OpenID Connect family_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>gender</name>
              <description>OpenID Connect gender claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>given_name</name>
              <description>OpenID Connect given_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>level_of_assurance</name>
              <value-provided-by>authentication-claims-provider</value-provided-by>
              <transformation>
                <input-attribute-names>acr</input-attribute-names>
                <value-transformation-procedure>ZnVuY3Rpb24gdHJhbnNmb3JtKGF0dHJpYnV0ZXMpIHsKCiAgaWYgKGF0dHJpYnV0ZXMuYWNyLmluZGV4T2YoJ3Bhc3NrZXknKSAhPT0gLTEpIHsKICAgIHJldHVybiAzOwogIH0gZWxzZSBpZiAoYXR0cmlidXRlcy5hY3IuaW5kZXhPZignaHRtbC1mb3JtJykgIT09IC0xKSB7CiAgICByZXR1cm4gMjsKICB9IGVsc2UgewogICAgcmV0dXJuIDE7CiAgfQp9</value-transformation-procedure>
              </transformation>
            </claim>
            <claim>
              <name>locale</name>
              <description>OpenID Connect locale claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>middle_name</name>
              <description>OpenID Connect middle_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>name</name>
              <description>OpenID Connect name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>nickname</name>
              <description>OpenID Connect nickname claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>phone_number</name>
              <description>OpenID Connect phone_number claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>phone_number_verified</name>
              <description>OpenID Connect phone_number_verified claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>picture</name>
              <description>OpenID Connect picture claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>preferred_username</name>
              <description>OpenID Connect preferred_username claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>profile</name>
              <description>OpenID Connect profile claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>region</name>
              <value-provided-by>custom-claims-provider</value-provided-by>
              <transformation>
								<input-attribute-names>data</input-attribute-names>
								<value-transformation-procedure>ZnVuY3Rpb24gdHJhbnNmb3JtKGF0dHJpYnV0ZXMpIHsKICAgIHZhciBkYXRhID0gSlNPTi5wYXJzZShhdHRyaWJ1dGVzLmRhdGEpOwogICAgcmV0dXJuIGRhdGEucmVnaW9uOwp9</value-transformation-procedure>
							</transformation>
            </claim>
            <claim>
              <name>roles</name>
              <value-provided-by>scim-claims-provider</value-provided-by>
              <transformation>
                <input-attribute-names>roles</input-attribute-names>
                <value-transformation-procedure>ZnVuY3Rpb24gdHJhbnNmb3JtKGF0dHJpYnV0ZXMpIHsKCiAgICB2YXIgcm9sZXMgPSBbXTsKICAgIGF0dHJpYnV0ZXNbInJvbGVzIl0uZm9yRWFjaChmdW5jdGlvbiAocm9sZSkgewogICAgICAgIHJvbGVzLnB1c2gocm9sZS52YWx1ZSk7CiAgICB9KTsKCiAgICByZXR1cm4gcm9sZXM7Cn0=</value-transformation-procedure>
              </transformation>
            </claim>
            <claim>
              <name>updated_at</name>
              <description>OpenID Connect updated_at claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>website</name>
              <description>OpenID Connect website claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>zoneinfo</name>
              <description>OpenID Connect zoneinfo claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claims-value-provider>
              <id>account-manager-claims-provider</id>
              <account-manager-claims-provider xmlns="https://curity.se/ns/ext-conf/account-manager-claims-provider">
                <account-manager>
                  <id>default-account-manager</id>
                </account-manager>
              </account-manager-claims-provider>
            </claims-value-provider>
            <claims-value-provider>
              <id>authentication-claims-provider</id>
              <authentication-context-claims-provider xmlns="https://curity.se/ns/ext-conf/authentication-context-claims-provider"/>
            </claims-value-provider>
            <claims-value-provider>
              <id>custom-claims-provider</id>
              <data-source-claims-provider xmlns="https://curity.se/ns/ext-conf/data-source-claims-provider">
                <data-source>
                  <data-source>default-datasource</data-source>
                </data-source>
              </data-source-claims-provider>
            </claims-value-provider>
            <claims-value-provider>
              <id>scim-claims-provider</id>
              <account-manager-claims-provider xmlns="https://curity.se/ns/ext-conf/account-manager-claims-provider">
                <account-manager>
                  <id>default-account-manager</id>
                </account-manager>
                <map-account-to-openid-connect-claims>false</map-account-to-openid-connect-claims>
              </account-manager-claims-provider>
            </claims-value-provider>
            <claims-mappers>
              <claims-mapper>
                <id>default</id>
                <access_token>
                  <claim>customer_id</claim>
                  <claim>level_of_assurance</claim>
                  <claim>region</claim>
                  <claim>roles</claim>
                </access_token>
                <id_token>
                  <claim>address</claim>
                  <claim>birthdate</claim>
                  <claim>email</claim>
                  <claim>email_verified</claim>
                  <claim>family_name</claim>
                  <claim>gender</claim>
                  <claim>given_name</claim>
                  <claim>locale</claim>
                  <claim>middle_name</claim>
                  <claim>name</claim>
                  <claim>nickname</claim>
                  <claim>phone_number</claim>
                  <claim>phone_number_verified</claim>
                  <claim>picture</claim>
                  <claim>preferred_username</claim>
                  <claim>profile</claim>
                  <claim>updated_at</claim>
                  <claim>website</claim>
                  <claim>zoneinfo</claim>
                </id_token>
                <userinfo>
                  <claim>address</claim>
                  <claim>birthdate</claim>
                  <claim>email</claim>
                  <claim>email_verified</claim>
                  <claim>family_name</claim>
                  <claim>gender</claim>
                  <claim>given_name</claim>
                  <claim>locale</claim>
                  <claim>middle_name</claim>
                  <claim>name</claim>
                  <claim>nickname</claim>
                  <claim>phone_number</claim>
                  <claim>phone_number_verified</claim>
                  <claim>picture</claim>
                  <claim>preferred_username</claim>
                  <claim>profile</claim>
                  <claim>updated_at</claim>
                  <claim>website</claim>
                  <claim>zoneinfo</claim>
                </userinfo>
              </claims-mapper>
              <default-claims-mapper>default</default-claims-mapper>
            </claims-mappers>
          </claims>
          <openid-connect>
            <expose-metadata>
            </expose-metadata>
          </openid-connect>
          <client-store>
            <config-backed>
              <client>
                <id>demo-console-client</id>
                <no-authentication>true</no-authentication>
                <redirect-uris>http://127.0.0.1/callback</redirect-uris>
                <proof-key>
                  <require-proof-key>true</require-proof-key>
                </proof-key>
                <access-token-ttl>900</access-token-ttl>
                <refresh-token-ttl>disabled</refresh-token-ttl>
                <audience>demo-console-client</audience>
								<audience>api.example.com</audience>
                <scope>openid</scope>
                <scope>profile</scope>
                <scope>retail/orders</scope>
                <user-authentication>
                </user-authentication>
                <capabilities>
                  <code>
                  </code>
                </capabilities>
                <validate-port-on-loopback-interfaces>false</validate-port-on-loopback-interfaces>
              </client>
              <client>
                <id>demo-desktop-client</id>
                <no-authentication>true</no-authentication>
                <redirect-uris>http://127.0.0.1/callback</redirect-uris>
                <proof-key>
                  <require-proof-key>true</require-proof-key>
                </proof-key>
                <access-token-ttl>900</access-token-ttl>
                <refresh-token-ttl>3600</refresh-token-ttl>
                <audience>demo-desktop-client</audience>
								<audience>api.example.com</audience>
                <scope>openid</scope>
                <scope>profile</scope>
                <scope>retail/orders</scope>
                <user-authentication>
                </user-authentication>
                <capabilities>
                  <code>
                  </code>
                </capabilities>
                <validate-port-on-loopback-interfaces>false</validate-port-on-loopback-interfaces>
              </client>
              <client>
                <id>demo-mobile-client</id>
                <no-authentication>true</no-authentication>
                <redirect-uris>com.example.demoapp:/callback</redirect-uris>
                <proof-key>
                  <require-proof-key>true</require-proof-key>
                </proof-key>
                <access-token-ttl>900</access-token-ttl>
                <refresh-token-ttl>3600</refresh-token-ttl>
                <audience>demo-mobile-client</audience>
								<audience>api.example.com</audience>
                <scope>openid</scope>
                <scope>profile</scope>
                <scope>retail/orders</scope>
                <user-authentication>
                </user-authentication>
                <capabilities>
                  <code>
                  </code>
                </capabilities>
                <validate-port-on-loopback-interfaces>true</validate-port-on-loopback-interfaces>
              </client>
              <client>
                <id>api-gateway-client</id>
                <secret>$5$UC2SBFz3Ue92dEiz$2fbxYuUG1duENPic7NbE70E9UWxlgmh314bEWZCBUn3</secret>
                <capabilities>
                  <introspection/>
                </capabilities>
              </client>
              <client>
                <id>phantom-token-test</id>
                <secret>$5$rObr5NZ.wJTz/9U/$HC.MVb9.BrHP/sjsMXF1SLoyDAXiUr8jiCjDvAooyJ4</secret>
                <capabilities>
                  <client-credentials/>
                </capabilities>
              </client>
              <client>
                <id>bff-oauth-client</id>
                <secret>$5$ZGYteVDmh6mv/Ctu$BXaxAqsPoN7dx8ed2A4Jrj9zgDYiztZcJIf1ucmC.B6</secret>
                <redirect-uris>https://www.webapp.example:3000/callback</redirect-uris>
                <proof-key>
                  <require-proof-key>true</require-proof-key>
                </proof-key>
                <access-token-ttl>900</access-token-ttl>
                <refresh-token-ttl>3600</refresh-token-ttl>
                <audience>bff-oauth-client</audience>
                <audience>api.example.com</audience>
                <scope>openid</scope>
                <scope>profile</scope>
                <scope>retail/orders</scope>
                <user-authentication>
                  <allowed-post-logout-redirect-uris>https://www.webapp.example:3000/</allowed-post-logout-redirect-uris>
                </user-authentication>
                <allowed-origins>https://www.webapp.example:3000</allowed-origins>
                <capabilities>
                  <code>
                  </code>
                </capabilities>
                <validate-port-on-loopback-interfaces>false</validate-port-on-loopback-interfaces>
              </client>
            </config-backed>
          </client-store>
        </authorization-server>
      </settings>
      <endpoints>
        <endpoint>
          <id>token-service-anonymous</id>
          <uri>/oauth/v2/oauth-anonymous</uri>
          <endpoint-kind>oauth-anonymous</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-assisted-token</id>
          <uri>/oauth/v2/oauth-assisted-token</uri>
          <endpoint-kind>oauth-assisted-token</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-authorize</id>
          <uri>/oauth/v2/oauth-authorize</uri>
          <endpoint-kind>oauth-authorize</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-introspect</id>
          <uri>/oauth/v2/oauth-introspect</uri>
          <endpoint-kind>oauth-introspect</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-revoke</id>
          <uri>/oauth/v2/oauth-revoke</uri>
          <endpoint-kind>oauth-revoke</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-session</id>
          <uri>/oauth/v2/oauth-session</uri>
          <endpoint-kind>oauth-session</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-token</id>
          <uri>/oauth/v2/oauth-token</uri>
          <endpoint-kind>oauth-token</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-userinfo</id>
          <uri>/oauth/v2/oauth-userinfo</uri>
          <endpoint-kind>oauth-userinfo</endpoint-kind>
        </endpoint>
      </endpoints>
      <token-issuers>
        <default-token-issuer>
          <jwt-issuer-settings>
            <algorithm>ES256</algorithm>
            <signing-key-id>default-signing-key</signing-key-id>
          </jwt-issuer-settings>
          <default-data-source>default-datasource</default-data-source>
        </default-token-issuer>
      </token-issuers>
    </profile>
  </profiles>
  <facilities xmlns="https://curity.se/ns/conf/base">
    <data-sources>
      <data-source>
        <id>default-datasource</id>
        <jdbc xmlns="https://curity.se/ns/ext-conf/jdbc">
          <attribute-query>SELECT username as email, attributes as data FROM accounts WHERE username = :subject</attribute-query>
          <connection-string>data:text/plain;aes,v:S.TkFYSHNUcDJBZXFiZ0k1Tg==.SzurxSHbgEpcdHj6XPCuqA==.4JSRI3Nx6lpBNK5OW54vbGPFrUCrKRtYZ5gfHJnQ30AzW_uQvpmVYcBGbALz-UMu.xoHLVVOyBh-VVuAd_n6rrrH3OY9cVe66-TMg0URXVX0=</connection-string>
          <standard-credentials-mode>
          </standard-credentials-mode>
          <driver>org.postgresql.Driver</driver>
          <password>data:text/plain;aes,v:S.NU9EaDhZS3BJRm5rcGVMNw==.GjelIFRvGm7WMhytrNtqWg==.PCAgqAXjftVzOHiRXnglVA==.Fz2ZWh-f8dcETI5ERsjwu0I69wdZP8AJS_sdwxyypbI=</password>
          <username>postgres</username>
        </jdbc>
      </data-source>
    </data-sources>
    <crypto>
      <ssl>
        <server-keystore>
          <id>default-admin-ssl-key</id>
          <keystore>data:application/p12;aes,v:S.dXdhWEtLb292NTNGcjcxQQ==.-LlethM1BWoHeMrMgPESsA==.Hwe3xBYHadS12OzlBNhiuGUX7dyCv-eK_ynlilJwspFRehSsb4zRYnF8ai70BqbypoRIq7tH7XU2HUP6qzROIKYorIwZWAP04z7CYK34pgxy95MYwwtTjtJGNxWI08tq3VZVNwi216iR0W_fcgyBQ-Y5ew45T4bVae9oKb9mbtiyXn8Azx6AYK6nfU1togE6NcxyfMWieV9yyM__S22WKlwUHKPDmk0Ypn86T4IBF7tTBNh3hBW9J0cFSPMJ7bTDYtCcdq5c2aAlHblUnLnEEqx645vxUoiln-sv_uQMmE0fN480zF4gAv8joV99WedoZcPXWD5dtN7CD7lpgCqLGgsurBcvg_2Ao8DE-DzuHKB2OG3GgasJ1N4LWHLcQlEPRwBgDxJ1a_W5iQ2KREY3yAdKd0YgsL9puy0Q3ExPJ7D91dQPhTfabqxljpGHjicpzRFK5040iSw4A0QWd5M150OME7gi0QoM7ns-dqdBHC2u4IodA2LhxLI_pl1K6lq649Zls_j8a2RKPEUA3jClwTBibHLd4YSWKLYioT6mc4PVgJjOcfLmLRqwEKNUiUotbOtJ6En5ABfusr7j7dwgPsqkn6iPfahaPzm_DFnJU9gp4PQsCePzkK2XNiTGL2rGBe2ilQLXBcu5dGZ9t0sFX-Bc8xbtcInMEBVerFTCmNLRLeEv8awvKOcfWjyoCt13ZTTYhmv-4Btt6iPvdRGPHX4GK33nEIGEIhIaqKeT82V45NbJqISPdM4vRcXYdl6OQFB-ygHQprKMHZxPDIkjlJuEoPtmzJBwDiXhtjsudAhK-svN3CFDIiKNsQIoD6MUcml_9XwBvG5dXQoSICwa8ZA4HSR9VRW0v9lXoGYSfaNLTL0Neu0O9uyTeZKruMHtmpicutOdjNLU1fOEsG5UlKyKP755wfhxzyGyOS3Z55OKe6I9n3DopZEjY0nh63tBpXm53Gp6CQ4PdSOi_Je9TjpOfd5HSZ25imCZ5d73vALrR7kiYloAteKVrJF5dAOmeFnlLZa1XWVeQWhXOkoz9wujmDV_3Rm_sgkwFbvgE2vOB9gQT0azWI63KGv6_9LfEjkF2-O8ef4ojHJr-BiXw4PB9WA6WVO3DTQuw8kNBi1UlXkmIt6c4YtJwDqooi4Zzsonj4mHGeI-90onXmD_PT7n9OqFy8EyAGFVdercVuW9Rc-csi__Hrao-BJ7zJrNjnAXHtSIIGgr5Iu1ulMklfNIrjJV7kLkYEBP1HasSoo8w33keaIXnnLxoGkiMnYlCDpgk_q5ciKx1PmMXVFWO0PQ9Q1YlQlXf0yCMJyaYxlztT5TvFoBqmzU5YjZ23tiL43btGN0rICUCJdqOI3ZGEScxHJCCFxCz0atFoQ5AGybSH0wv6jzfss2gOar0ni0LRI8EX8wLa9adDDIZ9n2ScUMj3CXnR0bQRafCDFjF6AbMNhTdW_xs1V5uG8FJ3uunKXpqAwvStQWjdnkkt7V_8enmSkHoYYa9eqVCvct5z7sj6yD0paZ5N6-AwLRb1276ZYqNQjjDW7-xFn9EG4QW5zn8tv8XCmqn3uOSSAUjMNZtu2znjMKwsCm3-AcQc57oaMX2Qb_jHL2xGJU31euZvFx2SbhVwRtwW5GD1bbXQmans_QthuD__zUoWd39SUs-jyJJxCc176IHHCcC0JYU6fWuoYrun4OZws72XJxuyIoQUdN3IXcOQJpXhcK1IWBcfBNd04gS4px_7kjG7UUuk9FH6J5Pg4TsTYewkN0Bhk02IkF5JpQWn_-LpQ6Q0JpDMjKyqB0a5PtFramFzF9ImeGm-FtwLRgvqrf3j554d87Un9nh30DOrzC44CDBDBWr1ZZO-qD9ULERLmM7pq4EXlrW6TGNjCL6_E25zaL7wqbgvWE29EimlvaJE5GlW-c97i5o4lXtjmLhmQaNJU-J6zH0Fsry3hsM3nB6tDDWLB07nxgZuZLcshOGd9tYR2TU2fd2UhukA3QzWJRibrJQltzCnT1N2f1EeVMbKGdYJzkS3lWYuDH_q8hw_gKvuPg22MTK22XLww2pFxuDJHQdDh76TXq_6vA1UN4dWz1tzzmXSO3VHsO83tPc7FfSsFJ1V6TQ6BrJ088Xub5kC1Z1XW6FfpOLnG1aCmmKEvcfzsKMi_w25R1pBGsRIZ-GIhjn6xiFQlRNJKQujnSxWH1feGJwC8jrW_iIbRDmUk4VFK9JClM-zra-oh_F9gypl6xEW7DmlyLgDjZOI8mUGxaP5IlPizC4xKzqP9szh3HcbnMcRXrK15axFW9q2yqstxm1Pu4kkJeZeh4MGlkPUlalvHJUPUlzcOpbwtgDvrRBfBCJD1zdvShTTD5c5u8gwX-u_NzJ4t4PM0pspS1cMjtyriniLg5DMtFl6zekI5LoXkaeCtHuyGHB7P75s3FvyVt0vNersrUvQn3MA110hWDMG-10T6faBOgSOeT47iX7NPNs7KIjjmKYsIEWy5enI1Tmb1-TFxV0zmZ6jpuSjLmDgWnqLkeXbDmMmOa_blLfJOZs0sm5va3lvpox1l3lSOw4Cg6R_ktqI06rfAXTVYr61FILbB_dZpLW1YQspWqKd45PVRcIoPuf2pmQ3YOS3dxymhaKjJEG4uDKw5kPAsKYgP4EtTEPG6IYr5r0pPLTP9_G9VBcp-Jp5eFa98fU1d30O5s8DRkJRVpt2iV1HcGbUxV7yGOr9UzAt9RAUUPPEFCBL3rdrjmbhzuTp1A3UU8qYm9GgbRD_OO8ULfs1gMaLKLdm1hYTumQGk3dR0CsGlvje__ijATpRfyfzWg11x3iPCijWVMiG2lvRfYPNAaTWRF31Qw36HekOOdRCZJ9GNfbRQ9aRtX833vAl1n0x03Smics7qc3DMDGWJuHuSM4KByB0dWbsP-jhTdFLiOEByHTs4fJzssxzddNFsQv3VZPBaJE_JwAhc6JIFxy-7SQZ_E9a_DwqmBawPQRUhKb1Mxr2xbZHZQWy4qLQ5-nsBx6MDoXkdW-t0i6XSOozqusaFhpppugfAN5_twhI4EP_ddQ7wCE3KJVeOGGEHoHiAYMW6_PAPzk0LAQJ8bGyQYn0Nfc6r2RTbK4MoYgmbHLJtCUdz-lOtGCGkO1RyIrKqGK4Ix9zUvjtrbuOzGhU6z3JkeyCJ3-U9FVNIofnLDB1NIIHvsGEDYWeyrrJYEhxDBSW79DZiKH7qU7gqMWaG2bSoez4UvUWVVG0LfUnkMrzl2mXEIcrRzGywE7ZGSPeLugg3-Yi82wGq6UySi3U74kElG7-NETuHzrfcYyOBT545Q3KIs7xf3Nd-FRFAfNjl0knQ7JQSHv_2-4QfltQRhlQzSv1mFANXFO2SVuZFQOk9Ya--b00el65vc3rzoeDef6cR77EDjPqqyxN1iPM7iFpZNhNZ7SGBzWVi5Bjdnh1llT5sXVi4n9qwsn4n6VpR8gPOxjciKh5fBtSoOThButcw5K7KEr2sM_4X-v4spQQTQHBPZtyVulHPR8BUTJ_RYLtVIqvA3B56diquuE101M0A3Vlk6hAZsDNIT-h-JqPIeVzo_bEKGRWuIyQg0itH_KiNwHt2SVRj7ORq2h4Kz3iBe_MzGp_1GG1LM5DOdQSPqR-YeLZ1T85n9OHLtbndK.JdQ7LX0gx7ZPuwDaHhnkqRTHCElnrerkBnCqWONBW1Q=</keystore>
        </server-keystore>
      </ssl>
      <signing-keys>
        <signing-key>
          <id>default-signing-key</id>
          <curve-name>P-256</curve-name>
          <keystore>data:application/p12;aes,v:S.Y2FnR2hCNlBhMWNMVXF2aw==.fkWrVyjO6-ekJLYvA4zShA==.IU7OK-UzeEaPUuimbczlNsVJpTYgrMsHc3dU-ZfDdA1rhw1KSQ92_eXESZJ4PIryvf53SIZRZlg-f95PUjBvY-f-zZD2gZQ7B9kq8crmQ0aYqEHnd6Wkj18pTdhMUVx2GOE1OZ4C4RK1ooPi3i1KmRTRSeiSjvZGBgb_BUL9Gc5vfhaDwvROtVT5OJ7WlHEn1wnBEyFeobraYuAPQuF-xqUC7fzmcF_eLxVMZEmhhj1U79N9bEAHZyTkQWfH39kpch2WL_HnrcYL7kU688xSpPKRjrc9Yn8PYtcVnOfRS2iCJf-lKp85sKAVmi8zUtx0bFmFCv_g1yheTxJMWkmmFGz9fAlUhXmLXNX301gRWG9_DDYO20kXvPPk_9FcMwWCbFaU1k_U73k8HqzbiuX8WzFqE009uzJG5Dnob2HhQmKQ0O7pkxu01rRqbjxrA2aG87YjUnzqPoynVrCJqGiqzKj10An9Zq9d-9l5T8pLfw9n0UWeAEWqM99I1dWki3GLfcVB8TThGjGCbfB1hNtsTkL-9ltzhVW90XNa8TcwhqrfoxaoHxG9iu-2kX2vGN4Ed6xKPhdg3u2Tdk6t96EIlNXm3X9S8KnqyCVnZmuzZt-6qbxkAZDs6yMiHgtnV1QP-T1q5N3nzXYMI4bIVHmVoxWZ9IbPPXM0S3DN4581cPHf3rFOefkRaS79w0FoTPEmpozQnwvIfPJXoL8cUIA60PIVnnH1GbSdh37iVDI2D_pZHSVrMpm94fiiMmYXbIOarduEk0o4fGur7nLHd5m2zwybnJKMFyXvEDYhyvsLOsirlotXsCsyRV7jGAj4xzaqu3Lma2qhcFtzO-opxoqnlA7-Jia0SY4GuO134WJRExAWsuP96LzYT92VKfXglhLs1qaps_VAl2mo3R5f5KP9ONcUgWupOzqBN7o9dVv1sj0R8utboNvguv9ub-11r2lhzurVvW57MS1s9xLuFeq1YbOrpFByTjylPqN5w--hx1Q4AdS-8qoJJzIf7f5U51N0EdCSxttPnHbjRcsw_Mt3pXHOkrkudDQLd5kyKzs4UwlBUyrSChl_yB3YebwMKbb_0Vc_V85xh6Uh60vTmVzmtAOePSKxl8jvl5BDPDQB5F6ue-U-q_KocZ6mSFoqpFE0aK8WFfHz4cU_1_XyWMUknoF9xcG5PyiF38juJeyTtB4b4AA_1au73IXv9Tnsxujz4xTHqO5LA71UnFpodwrup4PS-n1yUsZ8pXlpVW1S0QaLa3GcXVGcHGsci3WFAf8AlISp_d0Lb0PgBRJYBRiCn4dVcHmB7LbP6M4tNNuNFTh4jf4WOAKIsUruZlrFCrli.X5PRXuspaJJCtxPnUlmQfSFsvcY8rJY3tFL-5ZpbY04=</keystore>
          <type>elliptic-curve</type>
        </signing-key>
      </signing-keys>
      <signature-verification-keys>
        <signature-verification-key>
          <id>default-signature-verification-key</id>
          <keystore>data:application/pem;aes,v:S.ZzR5SjNqQTN5YjZ3a2U2dQ==.MVY7Rf4WjXtHISDceS2Oig==.FGqaO-WHPs6CE4q9zbsZMpXllu1Sw4AnOvWgSlxyL0Muec6kmO97Y4PI8iuUBjSDdymnCTUHGxASLy-peTnPVZSpKPpOqXSXIyulTAePHkRpFGPy_Opy9tN5db4IVSqe33qtiiqAYD4XD_W2I7cl0A4eldvrQqtu2SrmfMQhQ1msMLsCdzQsdRQJCBwWtszmH9CexzHcxqbywhhQh-18Ic-00iil1OuSAhfcH2QhH38XZOX0rNm5xGwngaGkPp_Vkw0uPvyGdDW4IwSeqRnF4H0teZIKXwx0mu-gAtKrQBZhkj-Pp3k7Y2AAQNXYKS1iLV6FWXGB31iOP2Mr_fxdwdDKoKMHrCuQ75OH29Y-ZFn_CeXMU5Plopgc_S-BG0rLCodrECWenaemq7lYRHGcP0NaHKj70nJERAXvrhKlRlEP8VQevCq22eknfE_lsIxrjgKVwDkCLpR8BhrusOeaj5ScZHO01PsSj3K7l13-H9O5_G0pkQrtRhgPtE_yaMNdCrwRF376sQfofgZG1pmbVhyx0CG1DoF7gq2nbT269IdvNFuhGuS31JQ2SuwhyyNvkd67iwmMqgMcdW2SqoDLcD54Vi3s_QkfDnfvgTQMx7W2jD6Ek37k82V9QeSVgufDb9_AO1z6ArFPFuBCCk0ylLFFd9MdKqhu0ynwfix4grgA8LnUCJITvuGC3kUFQAOZtLW1BQfnapt4_TIXRkWYezNVjk0PSScqD2pU16nUVMb7UT-tsmvFgwm2HAz27FDFpY0KwR8Iu31KRc0KrHxtj3pPpgGFvVy5ipXvRIJMUOb07yykWxRRqhlbOvTkAFnP7d-jynQ3656z6XOIsk1kDpfJvO3DJFBVtsK_Whx9Sig0jpyNJeKZLlzRMgniTK8-hydsI8ELH4eN-obTdj0S5fQoFRVoOL8sq4TrxwsrFt9WSlGTWEXusj7DZbDAZ8Lih3Nxu2DdwVlP_UuK2Xh4ASkkeN7laRwgu55aD56twnE0tG4vMOvGCOrCN_QAYbDH-TZvAal5nvtFLLaWyfUuE8cYeFSUq_2Oyjdjdz1_qzq8fvR5pb6KOX9DTv0eUOIu6FIS94mC8uRiY5_d5AdW9rUd9Q6D-JIGDCWKxcGybIhs9fzib7u0KTGNndD-GGo7Nmp-voHr1mw5aegCyCMhXTYX-n0cuQze3Dqio3dD4ojoMUKkIbipYBBHNJXOLPm1Sqfx2DZpc6Zw2eK6Th9CL26R7ioUjge-amNSLnmmAWI9gtjFDp1VG0IVLLRDteb1frozU6FtqJe-LXJiQ1dGvRpBCtUOEBref0vUdZLtqA8JMLcEYF73UjpzLpWkNfDsG8mEmcm3cUkLnmZF-ZQPs3IeTp7fhzvSiK0eje8jPG1FOPnkaItjQZeLXZsDBnyYI5H5Z7LuJiP2SUrDs5dsqPHx2-YrvxlH6usZWhOhZtslaT2q7ynHgjsQUkfpFsSyzsMkH_FvsrHDKwcGRkNlTYmd4_VbxgE6i7JAauq8ej2cFWnyJ5yXg0RYTlSOQ5tIFkULHVFwv52lgaGcbFDSvKVCexoL_CHbaDcz4IHxMTRtdOhcD-ahuVNTx8QLDXSz-UAjj0ilTP1gtWPx3uwLZn5X6mxVfn008VRJREEPnNbvbrU6RYqTMI-49Gir1Xz5.qHG6lBEF25RlaNDrVbZKtXIp1NuXQ1xlcMLsrCMEUqM=</keystore>
        </signature-verification-key>
      </signature-verification-keys>
    </crypto>
    <caching-services>
      <default-caching-service>
        <data-source>default-datasource</data-source>
      </default-caching-service>
    </caching-services>
  </facilities>
  <processing xmlns="https://curity.se/ns/conf/base">
    <license-key>#{LICENSE_KEY}</license-key>
    <account-managers>
      <account-manager>
        <id>default-account-manager</id>
        <enable-registration>
          <account-verification-method>no-verification</account-verification-method>
        </enable-registration>
        <account-data-source>default-datasource</account-data-source>
      </account-manager>
    </account-managers>
    <credential-managers>
      <credential-manager>
        <id>default-credential-manager</id>
        <Sha2WithSha256>
        </Sha2WithSha256>
        <data-source-backed>
          <data-source-id>default-datasource</data-source-id>
        </data-source-backed>
      </credential-manager>
    </credential-managers>
  </processing>
  <nacm xmlns="urn:ietf:params:xml:ns:yang:ietf-netconf-acm">
    <write-default>permit</write-default>
    <groups>
      <group>
        <name>admin</name>
        <user-name>admin</user-name>
      </group>
    </groups>
    <rule-list>
      <name>admin</name>
      <group>admin</group>
      <rule>
        <name>any-access</name>
        <action>permit</action>
      </rule>
    </rule-list>
    <rule-list>
      <name>any-group</name>
      <group>*</group>
      <rule>
        <name>tailf-aaa-authentication</name>
        <module-name>tailf-aaa</module-name>
        <path>/aaa/authentication/users/user[name='$USER']</path>
        <access-operations>read update</access-operations>
        <action>permit</action>
      </rule>
      <rule>
        <name>tailf-aaa-user</name>
        <module-name>tailf-aaa</module-name>
        <path>/user[name='$USER']</path>
        <access-operations>create read update delete</access-operations>
        <action>permit</action>
      </rule>
      <rule>
        <name>tailf-webui-user</name>
        <module-name>tailf-webui</module-name>
        <path>/webui/data-stores/user-profile[username='$USER']</path>
        <access-operations>create read update delete</access-operations>
        <action>permit</action>
      </rule>
    </rule-list>
  </nacm>
  <aaa xmlns="http://tail-f.com/ns/aaa/1.1">
    <authentication>
      <users>
        <user>
          <name>admin</name>
          <uid>0</uid>
          <gid>0</gid>
          <password>$5$vE5PVlNJ$f8x58oKjIVR2SfuSfChlzm0cVXwC7AW9m.jWRWXJBJA</password>
          <ssh_keydir>/opt/idsvr/home/admin/.ssh</ssh_keydir>
          <homedir>/opt/idsvr/home/admin</homedir>
        </user>
      </users>
    </authentication>
    <ios>
      <level>
        <nr>0</nr>
        <prompt>\h> </prompt>
      </level>
      <level>
        <nr>15</nr>
        <prompt>\h# </prompt>
      </level>
      <privilege>
        <mode>exec</mode>
        <level>
          <nr>0</nr>
          <command>
            <name>action</name>
          </command>
          <command>
            <name>autowizard</name>
          </command>
          <command>
            <name>enable</name>
          </command>
          <command>
            <name>exit</name>
          </command>
          <command>
            <name>help</name>
          </command>
          <command>
            <name>startup</name>
          </command>
        </level>
        <level>
          <nr>15</nr>
          <command>
            <name>configure</name>
          </command>
        </level>
      </privilege>
    </ios>
  </aaa>
</config>
