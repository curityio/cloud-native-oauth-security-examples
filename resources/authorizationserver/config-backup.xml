<config xmlns="http://tail-f.com/ns/config/1.0">
  <environments xmlns="https://curity.se/ns/conf/base">
    <environment>
      <base-url>#{RUNTIME_BASE_URL}</base-url>
      <admin-service>
        <http>
          <base-url>#{ADMIN_BASE_URL}</base-url>
          <web-ui>
          </web-ui>
          <restconf>
          </restconf>
        </http>
      </admin-service>
      <services>
        <zones>
          <default-zone>
            <symmetric-key>data:text/plain;aes,v:S.N3d3cUcxVlk2amdBUFRrag==.GnKAs-IuJ7gLZ6BT1CokTg==.sdim2XWm9_cpKN8LQAsXeRqK7bEZ5IrGGGbWX_FJ3TbjZdZX8ZQVa1wWbQszYVwrmyU-S9ckgXDDz82hAWN9YCvcX37URkd6oW4thOxvWsc=.kmrIee29Y6DSnj8m6cPvAMTsc8T5b2YQwFrZxd3KA0M=</symmetric-key>
          </default-zone>
        </zones>
        <service-role>
          <id>default</id>
          <protocol>http</protocol>
          <webfinger/>
          <endpoints>authentication-service-anonymous</endpoints>
          <endpoints>authentication-service-authentication</endpoints>
          <endpoints>authentication-service-registration</endpoints>
          <endpoints>token-service-anonymous</endpoints>
          <endpoints>token-service-assisted-token</endpoints>
          <endpoints>token-service-authorize</endpoints>
          <endpoints>token-service-introspect</endpoints>
          <endpoints>token-service-revoke</endpoints>
          <endpoints>token-service-session</endpoints>
          <endpoints>token-service-token</endpoints>
          <endpoints>token-service-userinfo</endpoints>
        </service-role>
      </services>
    </environment>
  </environments>
  <profiles xmlns="https://curity.se/ns/conf/base">
    <profile>
      <id>authentication-service</id>
      <type xmlns:auth="https://curity.se/ns/conf/profile/authentication">auth:authentication-service</type>
      <expose-detailed-error-messages/>
      <settings>
        <authentication-service xmlns="https://curity.se/ns/conf/profile/authentication">
          <authenticators>
            <authenticator>
              <id>html-form</id>
              <html-form xmlns="https://curity.se/ns/conf/authenticators/html-form">
                <account-manager>default-account-manager</account-manager>
                <credential-manager>default-credential-manager</credential-manager>
              </html-form>
            </authenticator>
          </authenticators>
          <protocols>
            <protocol>
              <id>default-simple-protocol</id>
              <simple-api/>
            </protocol>
          </protocols>
        </authentication-service>
      </settings>
      <endpoints>
        <endpoint>
          <id>authentication-service-anonymous</id>
          <uri>/authn/anonymous</uri>
          <endpoint-kind>auth-anonymous</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>authentication-service-authentication</id>
          <uri>/authn/authentication</uri>
          <endpoint-kind>auth-authentication</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>authentication-service-registration</id>
          <uri>/authn/registration</uri>
          <endpoint-kind>auth-registration</endpoint-kind>
        </endpoint>
      </endpoints>
      <token-issuers>
        <default-token-issuer>
          <jwt-issuer-settings>
            <algorithm>ES256</algorithm>
            <signing-key-id>default-signing-key</signing-key-id>
          </jwt-issuer-settings>
          <default-data-source>default-datasource</default-data-source>
        </default-token-issuer>
      </token-issuers>
    </profile>
    <profile>
      <id>token-service</id>
      <type xmlns:as="https://curity.se/ns/conf/profile/oauth">as:oauth-service</type>
      <expose-detailed-error-messages/>
      <settings>
        <authorization-server xmlns="https://curity.se/ns/conf/profile/oauth">
          <authentication-service>
            <authentication-profile>authentication-service</authentication-profile>
          </authentication-service>
          <client-capabilities>
            <code>
            </code>
            <implicit/>
            <resource-owner-password-credentials>
              <credential-manager>default-credential-manager</credential-manager>
            </resource-owner-password-credentials>
            <client-credentials/>
            <introspection/>
            <token-exchange/>
          </client-capabilities>
          <scopes>
            <scope>
              <id>address</id>
              <description>OpenId Connect address scope</description>
              <claims>address</claims>
            </scope>
            <scope>
              <id>email</id>
              <description>OpenId Connect email scope</description>
              <claims>email</claims>
              <claims>email_verified</claims>
            </scope>
            <scope>
              <id>openid</id>
              <description>Standard OpenID Connect scope</description>
            </scope>
            <scope>
              <id>phone</id>
              <description>OpenId Connect phone scope</description>
              <claims>phone_number</claims>
              <claims>phone_number_verified</claims>
            </scope>
            <scope>
              <id>profile</id>
              <description>OpenId Connect profile scope</description>
              <claims>birthdate</claims>
              <claims>family_name</claims>
              <claims>gender</claims>
              <claims>given_name</claims>
              <claims>locale</claims>
              <claims>middle_name</claims>
              <claims>name</claims>
              <claims>nickname</claims>
              <claims>picture</claims>
              <claims>preferred_username</claims>
              <claims>profile</claims>
              <claims>updated_at</claims>
              <claims>website</claims>
              <claims>zoneinfo</claims>
            </scope>
            <scope>
              <id>retail/orders</id>
              <claims>customer_id</claims>
              <claims>level_of_assurance</claims>
              <claims>region</claims>
              <claims>roles</claims>
            </scope>
          </scopes>
          <claims>
            <claim>
              <name>address</name>
              <description>OpenID Connect address claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>birthdate</name>
              <description>OpenID Connect birthdate claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>customer_id</name>
              <value-provided-by>custom-claims-provider</value-provided-by>
              <transformation>
								<input-attribute-names>data</input-attribute-names>
								<value-transformation-procedure>ZnVuY3Rpb24gdHJhbnNmb3JtKGF0dHJpYnV0ZXMpIHsKICAgIHZhciBkYXRhID0gSlNPTi5wYXJzZShhdHRyaWJ1dGVzLmRhdGEpOwogICAgcmV0dXJuIGRhdGEuY3VzdG9tZXJJZDsKfQ==</value-transformation-procedure>
							</transformation>
            </claim>
            <claim>
              <name>email</name>
              <description>OpenID Connect email claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>email_verified</name>
              <description>OpenID Connect email_verified claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>family_name</name>
              <description>OpenID Connect family_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>gender</name>
              <description>OpenID Connect gender claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>given_name</name>
              <description>OpenID Connect given_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>level_of_assurance</name>
              <value-provided-by>authentication-claims-provider</value-provided-by>
              <transformation>
                <input-attribute-names>acr</input-attribute-names>
                <value-transformation-procedure>ZnVuY3Rpb24gdHJhbnNmb3JtKGF0dHJpYnV0ZXMpIHsKCiAgaWYgKGF0dHJpYnV0ZXMuYWNyLmluZGV4T2YoJ3Bhc3NrZXknKSAhPT0gLTEpIHsKICAgIHJldHVybiAzOwogIH0gZWxzZSBpZiAoYXR0cmlidXRlcy5hY3IuaW5kZXhPZignaHRtbC1mb3JtJykgIT09IC0xKSB7CiAgICByZXR1cm4gMjsKICB9IGVsc2UgewogICAgcmV0dXJuIDE7CiAgfQp9</value-transformation-procedure>
              </transformation>
            </claim>
            <claim>
              <name>locale</name>
              <description>OpenID Connect locale claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>middle_name</name>
              <description>OpenID Connect middle_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>name</name>
              <description>OpenID Connect name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>nickname</name>
              <description>OpenID Connect nickname claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>phone_number</name>
              <description>OpenID Connect phone_number claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>phone_number_verified</name>
              <description>OpenID Connect phone_number_verified claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>picture</name>
              <description>OpenID Connect picture claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>preferred_username</name>
              <description>OpenID Connect preferred_username claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>profile</name>
              <description>OpenID Connect profile claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>region</name>
              <value-provided-by>custom-claims-provider</value-provided-by>
              <transformation>
								<input-attribute-names>data</input-attribute-names>
								<value-transformation-procedure>ZnVuY3Rpb24gdHJhbnNmb3JtKGF0dHJpYnV0ZXMpIHsKICAgIHZhciBkYXRhID0gSlNPTi5wYXJzZShhdHRyaWJ1dGVzLmRhdGEpOwogICAgcmV0dXJuIGRhdGEucmVnaW9uOwp9</value-transformation-procedure>
							</transformation>
            </claim>
            <claim>
              <name>roles</name>
              <value-provided-by>scim-claims-provider</value-provided-by>
              <transformation>
                <input-attribute-names>roles</input-attribute-names>
                <value-transformation-procedure>ZnVuY3Rpb24gdHJhbnNmb3JtKGF0dHJpYnV0ZXMpIHsKCiAgICB2YXIgcm9sZXMgPSBbXTsKICAgIGF0dHJpYnV0ZXNbInJvbGVzIl0uZm9yRWFjaChmdW5jdGlvbiAocm9sZSkgewogICAgICAgIHJvbGVzLnB1c2gocm9sZS52YWx1ZSk7CiAgICB9KTsKCiAgICByZXR1cm4gcm9sZXM7Cn0=</value-transformation-procedure>
              </transformation>
            </claim>
            <claim>
              <name>updated_at</name>
              <description>OpenID Connect updated_at claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>website</name>
              <description>OpenID Connect website claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>zoneinfo</name>
              <description>OpenID Connect zoneinfo claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claims-value-provider>
              <id>account-manager-claims-provider</id>
              <account-manager-claims-provider xmlns="https://curity.se/ns/ext-conf/account-manager-claims-provider">
                <account-manager>
                  <id>default-account-manager</id>
                </account-manager>
              </account-manager-claims-provider>
            </claims-value-provider>
            <claims-value-provider>
              <id>authentication-claims-provider</id>
              <authentication-context-claims-provider xmlns="https://curity.se/ns/ext-conf/authentication-context-claims-provider"/>
            </claims-value-provider>
            <claims-value-provider>
              <id>custom-claims-provider</id>
              <data-source-claims-provider xmlns="https://curity.se/ns/ext-conf/data-source-claims-provider">
                <data-source>
                  <data-source>default-datasource</data-source>
                </data-source>
              </data-source-claims-provider>
            </claims-value-provider>
            <claims-value-provider>
              <id>scim-claims-provider</id>
              <account-manager-claims-provider xmlns="https://curity.se/ns/ext-conf/account-manager-claims-provider">
                <account-manager>
                  <id>default-account-manager</id>
                </account-manager>
                <map-account-to-openid-connect-claims>false</map-account-to-openid-connect-claims>
              </account-manager-claims-provider>
            </claims-value-provider>
            <claims-mappers>
              <claims-mapper>
                <id>default</id>
                <access_token>
                  <claim>customer_id</claim>
                  <claim>level_of_assurance</claim>
                  <claim>region</claim>
                  <claim>roles</claim>
                </access_token>
                <id_token>
                  <claim>address</claim>
                  <claim>birthdate</claim>
                  <claim>email</claim>
                  <claim>email_verified</claim>
                  <claim>family_name</claim>
                  <claim>gender</claim>
                  <claim>given_name</claim>
                  <claim>locale</claim>
                  <claim>middle_name</claim>
                  <claim>name</claim>
                  <claim>nickname</claim>
                  <claim>phone_number</claim>
                  <claim>phone_number_verified</claim>
                  <claim>picture</claim>
                  <claim>preferred_username</claim>
                  <claim>profile</claim>
                  <claim>updated_at</claim>
                  <claim>website</claim>
                  <claim>zoneinfo</claim>
                </id_token>
                <userinfo>
                  <claim>address</claim>
                  <claim>birthdate</claim>
                  <claim>email</claim>
                  <claim>email_verified</claim>
                  <claim>family_name</claim>
                  <claim>gender</claim>
                  <claim>given_name</claim>
                  <claim>locale</claim>
                  <claim>middle_name</claim>
                  <claim>name</claim>
                  <claim>nickname</claim>
                  <claim>phone_number</claim>
                  <claim>phone_number_verified</claim>
                  <claim>picture</claim>
                  <claim>preferred_username</claim>
                  <claim>profile</claim>
                  <claim>updated_at</claim>
                  <claim>website</claim>
                  <claim>zoneinfo</claim>
                </userinfo>
              </claims-mapper>
              <default-claims-mapper>default</default-claims-mapper>
            </claims-mappers>
          </claims>
          <openid-connect>
            <expose-metadata>
            </expose-metadata>
          </openid-connect>
          <client-store>
            <config-backed>
              <client>
                <id>demo-console-client</id>
                <no-authentication>true</no-authentication>
                <redirect-uris>http://127.0.0.1/callback</redirect-uris>
                <proof-key>
                  <require-proof-key>true</require-proof-key>
                </proof-key>
                <access-token-ttl>900</access-token-ttl>
                <refresh-token-ttl>disabled</refresh-token-ttl>
                <audience>demo-console-client</audience>
								<audience>api.example.com</audience>
                <scope>openid</scope>
                <scope>profile</scope>
                <scope>retail/orders</scope>
                <user-authentication>
                </user-authentication>
                <capabilities>
                  <code>
                  </code>
                </capabilities>
                <validate-port-on-loopback-interfaces>false</validate-port-on-loopback-interfaces>
              </client>
              <client>
                <id>demo-desktop-client</id>
                <no-authentication>true</no-authentication>
                <redirect-uris>http://127.0.0.1/callback</redirect-uris>
                <proof-key>
                  <require-proof-key>true</require-proof-key>
                </proof-key>
                <access-token-ttl>900</access-token-ttl>
                <refresh-token-ttl>3600</refresh-token-ttl>
                <audience>demo-desktop-client</audience>
								<audience>api.example.com</audience>
                <scope>openid</scope>
                <scope>profile</scope>
                <scope>retail/orders</scope>
                <user-authentication>
                </user-authentication>
                <capabilities>
                  <code>
                  </code>
                </capabilities>
                <validate-port-on-loopback-interfaces>false</validate-port-on-loopback-interfaces>
              </client>
              <client>
                <id>demo-mobile-client</id>
                <no-authentication>true</no-authentication>
                <redirect-uris>com.example.demoapp:/callback</redirect-uris>
                <proof-key>
                  <require-proof-key>true</require-proof-key>
                </proof-key>
                <access-token-ttl>900</access-token-ttl>
                <refresh-token-ttl>3600</refresh-token-ttl>
                <audience>demo-mobile-client</audience>
								<audience>api.example.com</audience>
                <scope>openid</scope>
                <scope>profile</scope>
                <scope>retail/orders</scope>
                <user-authentication>
                </user-authentication>
                <capabilities>
                  <code>
                  </code>
                </capabilities>
                <validate-port-on-loopback-interfaces>true</validate-port-on-loopback-interfaces>
              </client>
              <client>
                <id>api-gateway-client</id>
                <secret>$5$UC2SBFz3Ue92dEiz$2fbxYuUG1duENPic7NbE70E9UWxlgmh314bEWZCBUn3</secret>
                <capabilities>
                  <introspection/>
                </capabilities>
              </client>
              <client>
                <id>phantom-token-test</id>
                <secret>$5$rObr5NZ.wJTz/9U/$HC.MVb9.BrHP/sjsMXF1SLoyDAXiUr8jiCjDvAooyJ4</secret>
                <capabilities>
                  <client-credentials/>
                </capabilities>
              </client>
              <client>
                <id>bff-oauth-client</id>
                <secret>$5$ZGYteVDmh6mv/Ctu$BXaxAqsPoN7dx8ed2A4Jrj9zgDYiztZcJIf1ucmC.B6</secret>
                <redirect-uris>https://www.webapp.example:3000/callback</redirect-uris>
                <proof-key>
                  <require-proof-key>true</require-proof-key>
                </proof-key>
                <access-token-ttl>900</access-token-ttl>
                <refresh-token-ttl>3600</refresh-token-ttl>
                <audience>bff-oauth-client</audience>
                <audience>api.example.com</audience>
                <scope>openid</scope>
                <scope>profile</scope>
                <scope>retail/orders</scope>
                <user-authentication>
                  <allowed-post-logout-redirect-uris>https://www.webapp.example:3000/</allowed-post-logout-redirect-uris>
                </user-authentication>
                <allowed-origins>https://www.webapp.example:3000</allowed-origins>
                <capabilities>
                  <code>
                  </code>
                </capabilities>
                <validate-port-on-loopback-interfaces>false</validate-port-on-loopback-interfaces>
              </client>
            </config-backed>
          </client-store>
        </authorization-server>
      </settings>
      <endpoints>
        <endpoint>
          <id>token-service-anonymous</id>
          <uri>/oauth/v2/oauth-anonymous</uri>
          <endpoint-kind>oauth-anonymous</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-assisted-token</id>
          <uri>/oauth/v2/oauth-assisted-token</uri>
          <endpoint-kind>oauth-assisted-token</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-authorize</id>
          <uri>/oauth/v2/oauth-authorize</uri>
          <endpoint-kind>oauth-authorize</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-introspect</id>
          <uri>/oauth/v2/oauth-introspect</uri>
          <endpoint-kind>oauth-introspect</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-revoke</id>
          <uri>/oauth/v2/oauth-revoke</uri>
          <endpoint-kind>oauth-revoke</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-session</id>
          <uri>/oauth/v2/oauth-session</uri>
          <endpoint-kind>oauth-session</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-token</id>
          <uri>/oauth/v2/oauth-token</uri>
          <endpoint-kind>oauth-token</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-userinfo</id>
          <uri>/oauth/v2/oauth-userinfo</uri>
          <endpoint-kind>oauth-userinfo</endpoint-kind>
        </endpoint>
      </endpoints>
      <token-issuers>
        <default-token-issuer>
          <jwt-issuer-settings>
            <algorithm>ES256</algorithm>
            <signing-key-id>default-signing-key</signing-key-id>
          </jwt-issuer-settings>
          <default-data-source>default-datasource</default-data-source>
        </default-token-issuer>
      </token-issuers>
    </profile>
  </profiles>
  <facilities xmlns="https://curity.se/ns/conf/base">
    <data-sources>
      <data-source>
        <id>default-datasource</id>
        <jdbc xmlns="https://curity.se/ns/ext-conf/jdbc">
          <attribute-query>SELECT username as email, attributes as data FROM accounts WHERE username = :subject</attribute-query>
          <connection-string>data:text/plain;aes,v:S.a0c4RlAwYmEwTXo4REdObg==.CxIpawZ2fJIEiy0vvwLs8Q==.uoo2Bt48F_V2iqFpF8SHfBT7Py3pEwJdEBEdegp10a5R8IcWc0bA-waRQER91ruw.fP4fCKjCTh7Ps7of72lT6iZEcX2TA_6U9iWhnxSkb-c=</connection-string>
          <standard-credentials-mode>
          </standard-credentials-mode>
          <driver>org.postgresql.Driver</driver>
          <password>data:text/plain;aes,v:S.T2EzNDNGMFF6S3FKZ09wZA==.zdYbNVRdmfEpWE6Y6J46og==.xniycaDH9R1V5K2xM0uXOA==.5IbD4vFaQxFZhvw3QYyXxtElDEUB4aLZwrm0eLBYI94=</password>
          <username>postgres</username>
        </jdbc>
      </data-source>
    </data-sources>
    <crypto>
      <ssl>
        <server-keystore>
          <id>default-admin-ssl-key</id>
          <keystore>data:application/p12;aes,v:S.REVmb1VMazdMUURGb2I5OQ==.iev_AiOQdfINft0KiIPbzA==.aAEtHRB7JBMauTHtqkrTj3mjBN5dVTRYwdN8WAx8CbitcQNYoxWtFT41q1Qj8h2uM2Qs0C_C6fAdZJMUCVRiMadvf5MtjlYWFZpsM-CLelaEqrAV-eCXhJqzmJNlyevupGId4sY1044cvYXGWezej7z05FHnH4tWembWmfDjZhK5n2oAvrDSZnAkM_czTeUqb-7T8xXNBahJ_DfUxKNkHuTFPmqSs9bh-uZ4Sa58bK5Vxbkjd71smeVcK7x7wUdG3dcEAXkupgfUH0Dqoz02SMDygSgMlx8kZv_ON9YBERcJR5NJ2B5z4YvYQhNJQi_RpWoB5O9_4CyiixEY2HGxL3siUMVYIUZyV806kXbQ5r-FpiCjr5S28Wt6yA37Xp8RZ3oIW9Nt63oa8fyVDDDJoCU_BMA7kks28xpwvD3MgYeHHMyK5Nsh6ZU1WoqDzbUtMYWbyRWmAFKiyu-iuk93zbTOynl4eQFBHO_Y-gHIKj0dsFj32EHbYoZs8qhEv7ienA3fU7ENBPIkqp1mgxqAxeucmtkHWoeO-s1IPC85M9hSz8Io0t0nziUJouXrwxLANKOZpm6CDGUgyvZAWLmRTHiw4P22mrm4VtW4_oUk3c3hv2mZK4zPUBPokEMFEKFMh7HG9IJuBecEnGq1q1ciR4i1NRHtoYhFAyr_XsEiv_8INcSkHsJIjfnME78dObrC833um3Vt435k8eD8tGOohd7LWzuChESibC1wDQEXrAPGnlDbF918Kep7k6OH18t8-EBfJDSQtNfrcPcO50Mif36d7dMT_-XeQw_Q9Ckb7kQIoTh98ZKoa18jLdwATUh8UfOBJRqN_-PAxWp1YcrIjmDD9dgI1bIE66mkGqSENAbh8h9TAk9kOJwZRIcwePaHNWMCHUxCK8r5Grei-8mbIFNNAR9-rqDGFHZGm2RiUlks1ec-p3C08JHt7iAlRbgc6nPMYU_HlaKnZOM0EqfNMnh4BO_ApXFAAOYr8pYqNq0jJUbRT5W5JURmfx2vvg5jzsY0gufQ8WRI3x_Q_5IGruO8JGL_iSFlQLHmhlkjw75VTyQf8h0ptaGWZ-nV-dJISEFV0-BAe24Dw_EYzv8ZVz9p7staPst559Hpk8s4KTgEClief4BKWsxMPA9woL5PeS7kcUA9RlSTuDLdAwBrq7ccPIjLPXd7ZDa3qbTAwBhgH0FeYewd8BwKGeOwN4DwbP5_9j7f8PsELFR0Bf1Pzr9cNUMxO7v5usf4uxJWFlDRQ9gYwlcpQ80negPpDwpczFmFCUcJeC0cpgvT-wk0VPsYA4ToF428ChlRpwP3zNRjXSnVl9Bhlxh68afEOgvs2EA7Zrveb5SUMAkRlB2c_UA8PUzCwzzX3mDiKLPiwX8HdzTP8L36cPSc87Cz8UO4YMCfYm1CID5lLcsmkqOWj0UZcgUCFusboJ90QsKFb-7oCNmaysmxEdE9aHdRQgGL_ige0EUrpeYv6Ap-1NnkXQJ-c3CUHl4ooIX3rHTzYx4QPwx7coWpAIHQyvgHGWxjXXf65bri7i-PNcppmtyht4C4V1faMao5rPbSmeQuG7cIQsdQnXy6RhNPaTm5gX_jeaprsrRSKd5lmTZ_QBODchc2IqIyJJfcVec4d9LlQ3zm3opDatWzhw8TWvdkV_azOu3dOf4ZpIfD8U5VwaWKZS9FLWSNbw8rGKxioHli2qq9kXIyx5-NtPWHW3aU7Vlq1zVMtXo6O1mCBHwPi0lB9wWgOcbPKHOED-WE7xKCPfhvnpZ42YfaOgu9dl6_b6BcrmXR-lnpTr644V3-c3nIe6xJOUnQkDt1Ix6Pw7xEaYGTbTFot9vzMeD30klzf707N2PTqMsZ-v4WsPFR2bE2rtWJgAqvmO1ARYIgS9BYEJBEGGhcHxvcXWvk1R6lPkNhMy542B7H80yVAa-YOqyXnuWPPUSIJI1bV5AksFXbOxm37Y7Qdm2UvQ_yoYgcgc-A1hTcHmTSXc2B6rJOOEbkZmWYaCmy7GTzOKN-fj9Dn8sUGDkmxG2jhoLJz9pz9icsYIZmJ2RY-B766pRmykVRbKx5QYFhf2D7og1ddFAKFrxgfS1KJvlEzoDeDxAGijCpubQt3YEDoloTlR3ivxf3YGPNd9wUpnJ3rxxpEnqhZyKBelWm65Cw6pPWd5-nIX-a-ieYrMNyxGcM3s0jzFvTjxl7F2wC7qFw2_lCT-fQme_t-hZmgbg-HMaVcbktKzhnZTtSOMLGGLayQE_VP1WnoLF-B5e7UrrO3PH3E2AvsypZZYubGwzcP5XbFhgBfQt0ltyKAVMpKLKCsIEYYdTwCV5O8CvQpuCy_2R4x4bnVVYOIIE33M396edXGR5mpD_LUUgF4N6K4kiCgZBLtmr_glNpB1CqDPiYWwkAPm1KoyjoFvssnI7glAfFBItY0tkQGJdlALfs8Vuqao5WIjwI7bAOqaW6YVIimCUKKPgFO_F1GIyhx36E3ZcgOPrCkhBFByi57fYFzyQmzqRuRl-c6hT3kSX0WbEmT77wOVYNCmQ6mH2s4tGHfu1e5bLg2Dk2rlvVqtkLTOdEY1711MZBdUJGzytpmZeXNXYB0_sS2QeIrTsybSyiE9gBrvejcq6qGlV6VyPfqAl8UwyhbIZPDJBR--Ge-AZIKbCl-Gu3fmRZ3r7fzCjCPS-tNu8DKe1I0K9_0SdPSlwx4ix3Y_bLFOx9hhsZZAoTgfyud5N1NWLtFzi-AnEp8mMNrXgtaFsABCbXb3eloAoo-7CRuXHuaT3rgdfzK2klijqkt11vod70bsk9sIyuL8oW0ot0ITf4ZKv0MVqdMpTkujd-7WmTJ4s5i634BzJUz8Z6qNqLw6Y-2tC0ImFo7GPNY6MBGMKAeQIkepcw65I3-WPJi6VASsQNRQIoBpLHaZXCtJplzOgWEcCAutBXnxuMcGt8straIpvc8mAtXEZH0Z9PAxWjqYusFm7qyl_rEDIgVSlFb_-a7uf0-LVoeLhFt5LM25b4tX5pc1-nO3AU9-7LX9Hv6CwjwA-67c7yIG-Fcog9ZdXyPHbntTW4vKM1NBqNL8S7PyeRSd2nfP8Jv5y3Zj5aSqxihTsa7PqrTDhhfhoGLAToJ0ip5NhDeQfe9ks30drpA8MuZAVQiwK66dV0Rq2_FxVy2bsyuJwK0stVmclPdicD1kfL9FZ1JNOj0VN251IcXXAhbrXX7d6IXZZRNtbT9CtZQuovK6dPfnp-23_-MMW6Z3n5-5pfWmelCac_4VyfCkxWqaT-R2P4GIQCfvbzDqqVM94Z2cIxATa1Vs14M8Fw3JtZcaKT1PCF4-bJ6cceeo7dfWCGGZupfo2uUY4EHOOEB3XjiSnExxXqQQqxOS408DAtoAT4T4nMDOc-R1mv9rK0cSsuWhyrke9ut9PAf8cc4-OkwDsDG6U5-QSJMdkff0txztuiMnHiUV0sH75NxTsEteiDoNUDGz5elxFAsr4p4LTd4oV8eK3wb2EAO_9eSjTFPeTkOOKdKtU4l7r5cU1XFgufl4wl6ld0SFWAg7_YBROaY0br31D6L1cwsO5VsletuHR51ppwZD6kYODZiv_t5wq4IRB_qaK2B8B6QbijOerbc7jolNJ8j-FAXVI0JcKLqhiGgJOD1-nR5x40FMjed4495Mr-XTA821yc6EuMrDf9vgk7xaemAv0TI1uvC0Qmw6WyLeIDiKYWMuQ9fTjs5SS3jmGDBTPGZpSaNw==.DeTC7hN6hNFCXCH8WdSLD13pJoGfhCiY4NJ_qXFsk4c=</keystore>
        </server-keystore>
      </ssl>
      <signing-keys>
        <signing-key>
          <id>default-signing-key</id>
          <curve-name>P-256</curve-name>
          <keystore>data:application/p12;aes,v:S.Q0J4NmZ3cDVTNUhPa1l3Zg==.Ph2NeHMI4bhz_-krFo2Ypg==.ivBgbDhkY6z5dLNH4Av8tKZ0FmbfjKWEIk3jYwscxc720ZtKvzhHars6SVr2R-T1EX-sXkgdlv41VBZH9cYqXC62ZrWoYE5yMK64AGNC7FFt7srnPqhMEbBN6RFcY50shuiPhEKXfYPfbRnsG6khl3vpqVJHjFJiuHiPxLy-t6v7YqJ-dTXWb6mRO9lpfNoALf1rK1dzVp3sYuHu5BpwVQ8OFT1LaeJSwgXqM3dqveQdszC28mbRwebMjhi4zjb5sdaOdV0ztxIO_3em40HLDYDF25kVuofmzjX7Q25ZeOw0QQ9HqyDF9owUKTUd5XsxzqBDLkb2Eot6V-ZMUNTJY3PZI_rST6Ynqqvk_PUMWAvxAFT1jF9sFvPo5X29GGSOlb8ix8G7chezw-fpvd1gx7q2aDP_vDzFThgrxm6_O4wTDr5QU3k2J4zBinidfLIbaQrob8p_gexQY4E_8aSKtlnjrXhX8-SSQJ4FLgtFwx3eAY5qMqeZgVLePoH5ro2zKZfLhuBgFOA-efV_KNM9xXMoH8O9A4vlkibxYp-mD_PRVTP72F1ek4anzzeBgzDlCiDfmR3MOgGMtNKMioQeYTkmM5VREK6TAu0h29QUcqo2YPkbpRqNIiaxfwwulpB-6RpvIpQ4OWRjKKIekjYKfm-Buwq5wEnc_ZQeehDjtgpcQ1DrFRW-k7J3HLgzR_BNy3nNbSEljo_tc4aHKG_mvObWuzdj5-zZeyZ-ncfcyJN3rlvEDyoYkIpplIz0h_w0_eyjE6ntj6-0bu7DrHUENyYC3SBpMPoyNkm2XCeJcR9Z5I-uv3egW9P3tRy1spS1TLKnZcsywVf6aJC2JRULW6yBHl_pmphzC7OvB45NCIqlo0cEAFYT_h7HeFHRxj5hwW5FTvzfXeGUUupo3yMFgGiXWOhJp-NzLUJCu-Qd6at614g0QObdx57BBxNaurxaGKh9nwm_WLPpE_n4MN3Tzt1JTnxQTPVX0O__mmYNTh1sjJjmS_on16guIYoDCfPCWlriHjh36JafrFyyqZ8pj3fHHe86xwXsQ6SUSR1Jx6iycuS3SbQPuMH6wz1j-H7NtHLPrc0OzfOq-9JqPrAspX60TCFJe2gR3Ye0RkdF_ta4Jldlxw8-9_yjT9gboq1xAt52ZPtk6uH9jFddQmO9aaVi4uBEYvn4cQHOgDUun3veisnsmOxf85dSHUZm5SqjK6N6AldT-woEhc0J7RSZjnJxXpjgxg4sQ_chCJG1KZuKplL0gjy9eISIlWbp1k2bw0yZF6Z8r0ttk68fHDJJQslaqfPvZmr9QskyFA_T9JoHtGiBdNECYOWavLiqj78E.XDFDDvkqY3YWqGR5nvcqhgSRIbHN-e5poK40T4n6NgQ=</keystore>
          <type>elliptic-curve</type>
        </signing-key>
      </signing-keys>
      <signature-verification-keys>
        <signature-verification-key>
          <id>default-signature-verification-key</id>
          <keystore>data:application/pem;aes,v:S.c3k5RmREUDZJc282T0ZMeA==.leYJgJym16w0gkWziSmMLA==.Q0oTZX0gAeu5Ughu0iCbu7iEY903nehAgNAiJYZp5EOJkpUWkEv3iG9PCNghbnRWGuMCSi77Z4Fd5ka7CX_65f7HWdyC9S3Y9G0BZps4ivVrpif2lxxtKs-_jBTuo3VDpQ3gzsNGiq40VhWKfSiGn3sujbJEfQ12n0xsxcnhYNI7iWOSfcbt7Tt1vZ-5ok_g9ElZ2s9P-wZeKuiJ58wDTiHk2f11F6Bpe2MhuoJmsXSca4mVXNcr_I7E_WGfEHdj8O1FBH-H1ilYtrSMWpGeBDjj1xYqP4KngFDjq1qsgk4BCKiOEVnYi1qhalh_6wsxbZV3288tjyC_OaXg86qa0yDmXqH1pCSbw3oC2MkiCuUQOniN-xBgFzIZRvAx36Ukh5T3I0qCf2zO1PJvVjSPfDrNFAmfC-yU4zsuB1wH4_gLNmLQ69b5fVZLizAEDTYAOebDnVsz2EmyVrIObC5yxZURo0DlV8dbrkn9Lm_rh8kRK69ArqGGQ_CFhoMxs7stPiYMQHpAd_BGAiUel3yOxEQujzLPV2fBDD5gOw62dkImew6SecumT6KfYs6N5scHTcq8RDbqelVnPIpmjIztcF7mXzfHplbv6iYhxj0uEgJiM2N1l9mVQbn8GfeIY_V8gxR0MsblmapKwA-Zj9lUlDiEM_mErQ8dXsCP4xhl9HZe4dtzBzpiGNOePHlYZiO6hsei7L0DbvoJ1UabWBrprgYZt7_aP0DRFG6RzN0fy_bC1uXozcK7QqltAfvF9wjfa7VZ1VhFAQglv8JPohcGkkZDKfhqLAkIzea11qh8bymbwTM83xLhiOStArnQgX-1XkaTJaWyGGGpwCCD0iYobCtflD3ig99sG1kxZIRpgFm-gIL8IaLJJxVpWHLy1H13JNX73Dxbuh7OyIcyvfbwjP5SZL46-nFAx8wyYIuOlYAiOHDqHlgNT5l1nFWRO2vRRmiJ4oBoQoxcEQuS110fy39uVbCwe6FwUQNo_JAQyKA6C-gn0kq5YN_pTFavFiO-AEJM5MVkT7fxh2NdrLS-osaAp60XvYt0hkchqv2Ak9X6e5eySWqAopcX_wYlI1Yl0K-FZcPsRvXIRekRSPE3OCFFVbu4d5voj38Wu2BYyknfKkj0j2mGn6Q4opmi7xcrILKjxgPDIp8mDjGx5eGiTayNArqtzfKVpkKSbahv4HT0BnUKMut6gNizHB9K4RofOpqdeBI4BAy8fOnURfJkNHSp5EbVUIG80mVQIRqROI0W9t3I1f4qAWnbm55LiRg2gfngi09pbn8hnBoSWiA0oJg693Mk4Zqsbd8O2lLUgE4f_7aD5HrjjE6GKQsM5s4Zfgf9v9hqUybd6592x2RXY8MpILNIW_IrDQJTxumySLOMIe4j3S0M0sFiYLelHSuH5T49IUnZZDsfOL8NVxZnhPLZSUqDeBl07oa74KeSyMhe3t1rYvWBrFSLTssOfPqiRg8to1bS3bgjZXX86kPTTYLKjUMya3-3wQHOi4ULb_RBf5KnzebOgOB6E8CJVuBTEJj11D7CJ3Is6UfGDAUuXqaLriE9TEhB269S3JPcX_52PFygrPUifDV8vTEaX7d6JnBq9OvlQPYFISjTssoCv8eiUpmp3x2rq2gB_VcoDzqG0HY4lcPjAR5cp9Zo9hsCcdkCqhXE4LwOPXf4dYo-BRocflN0halmg4uQmXOUuI1UviHSh6fSp09RShMS3fsFghhTcDqbm5INp2nHj-Rh_qKAGDtrqbnYZLQSQjI6WmIkWxYVtpvO6CZuS-fHGw9n.K38WYhOjim55ddfQ-QMIlnyMABsl7pa3o0BMqyLX1IM=</keystore>
        </signature-verification-key>
      </signature-verification-keys>
    </crypto>
    <caching-services>
      <default-caching-service>
        <data-source>default-datasource</data-source>
      </default-caching-service>
    </caching-services>
  </facilities>
  <processing xmlns="https://curity.se/ns/conf/base">
    <license-key>#{LICENSE_KEY}</license-key>
    <account-managers>
      <account-manager>
        <id>default-account-manager</id>
        <enable-registration>
          <account-verification-method>no-verification</account-verification-method>
        </enable-registration>
        <account-data-source>default-datasource</account-data-source>
      </account-manager>
    </account-managers>
    <credential-managers>
      <credential-manager>
        <id>default-credential-manager</id>
        <Sha2WithSha256>
        </Sha2WithSha256>
        <data-source-backed>
          <data-source-id>default-datasource</data-source-id>
        </data-source-backed>
      </credential-manager>
    </credential-managers>
  </processing>
  <nacm xmlns="urn:ietf:params:xml:ns:yang:ietf-netconf-acm">
    <write-default>permit</write-default>
    <groups>
      <group>
        <name>admin</name>
        <user-name>admin</user-name>
      </group>
    </groups>
    <rule-list>
      <name>admin</name>
      <group>admin</group>
      <rule>
        <name>any-access</name>
        <action>permit</action>
      </rule>
    </rule-list>
    <rule-list>
      <name>any-group</name>
      <group>*</group>
      <rule>
        <name>tailf-aaa-authentication</name>
        <module-name>tailf-aaa</module-name>
        <path>/aaa/authentication/users/user[name='$USER']</path>
        <access-operations>read update</access-operations>
        <action>permit</action>
      </rule>
      <rule>
        <name>tailf-aaa-user</name>
        <module-name>tailf-aaa</module-name>
        <path>/user[name='$USER']</path>
        <access-operations>create read update delete</access-operations>
        <action>permit</action>
      </rule>
      <rule>
        <name>tailf-webui-user</name>
        <module-name>tailf-webui</module-name>
        <path>/webui/data-stores/user-profile[username='$USER']</path>
        <access-operations>create read update delete</access-operations>
        <action>permit</action>
      </rule>
    </rule-list>
  </nacm>
  <aaa xmlns="http://tail-f.com/ns/aaa/1.1">
    <authentication>
      <users>
        <user>
          <name>admin</name>
          <uid>0</uid>
          <gid>0</gid>
          <password>$5$vE5PVlNJ$f8x58oKjIVR2SfuSfChlzm0cVXwC7AW9m.jWRWXJBJA</password>
          <ssh_keydir>/opt/idsvr/home/admin/.ssh</ssh_keydir>
          <homedir>/opt/idsvr/home/admin</homedir>
        </user>
      </users>
    </authentication>
    <ios>
      <level>
        <nr>0</nr>
        <prompt>\h> </prompt>
      </level>
      <level>
        <nr>15</nr>
        <prompt>\h# </prompt>
      </level>
      <privilege>
        <mode>exec</mode>
        <level>
          <nr>0</nr>
          <command>
            <name>action</name>
          </command>
          <command>
            <name>autowizard</name>
          </command>
          <command>
            <name>enable</name>
          </command>
          <command>
            <name>exit</name>
          </command>
          <command>
            <name>help</name>
          </command>
          <command>
            <name>startup</name>
          </command>
        </level>
        <level>
          <nr>15</nr>
          <command>
            <name>configure</name>
          </command>
        </level>
      </privilege>
    </ios>
  </aaa>
</config>
